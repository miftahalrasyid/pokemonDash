{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { Observable } from \"./Observable.js\";\nimport { iterateObserversSafely } from \"./iteration.js\";\nimport { fixObservableSubclass } from \"./subclassing.js\";\n\nfunction isPromiseLike(value) {\n  return value && typeof value.then === \"function\";\n}\n\nvar Concast = function (_super) {\n  __extends(Concast, _super);\n\n  function Concast(sources) {\n    var _this = _super.call(this, function (observer) {\n      _this.addObserver(observer);\n\n      return function () {\n        return _this.removeObserver(observer);\n      };\n    }) || this;\n\n    _this.observers = new Set();\n    _this.addCount = 0;\n    _this.promise = new Promise(function (resolve, reject) {\n      _this.resolve = resolve;\n      _this.reject = reject;\n    });\n    _this.handlers = {\n      next: function (result) {\n        if (_this.sub !== null) {\n          _this.latest = [\"next\", result];\n          iterateObserversSafely(_this.observers, \"next\", result);\n        }\n      },\n      error: function (error) {\n        var sub = _this.sub;\n\n        if (sub !== null) {\n          if (sub) Promise.resolve().then(function () {\n            return sub.unsubscribe();\n          });\n          _this.sub = null;\n          _this.latest = [\"error\", error];\n\n          _this.reject(error);\n\n          iterateObserversSafely(_this.observers, \"error\", error);\n        }\n      },\n      complete: function () {\n        if (_this.sub !== null) {\n          var value = _this.sources.shift();\n\n          if (!value) {\n            _this.sub = null;\n\n            if (_this.latest && _this.latest[0] === \"next\") {\n              _this.resolve(_this.latest[1]);\n            } else {\n              _this.resolve();\n            }\n\n            iterateObserversSafely(_this.observers, \"complete\");\n          } else if (isPromiseLike(value)) {\n            value.then(function (obs) {\n              return _this.sub = obs.subscribe(_this.handlers);\n            });\n          } else {\n            _this.sub = value.subscribe(_this.handlers);\n          }\n        }\n      }\n    };\n\n    _this.cancel = function (reason) {\n      _this.reject(reason);\n\n      _this.sources = [];\n\n      _this.handlers.complete();\n    };\n\n    _this.promise.catch(function (_) {});\n\n    if (typeof sources === \"function\") {\n      sources = [new Observable(sources)];\n    }\n\n    if (isPromiseLike(sources)) {\n      sources.then(function (iterable) {\n        return _this.start(iterable);\n      }, _this.handlers.error);\n    } else {\n      _this.start(sources);\n    }\n\n    return _this;\n  }\n\n  Concast.prototype.start = function (sources) {\n    if (this.sub !== void 0) return;\n    this.sources = Array.from(sources);\n    this.handlers.complete();\n  };\n\n  Concast.prototype.deliverLastMessage = function (observer) {\n    if (this.latest) {\n      var nextOrError = this.latest[0];\n      var method = observer[nextOrError];\n\n      if (method) {\n        method.call(observer, this.latest[1]);\n      }\n\n      if (this.sub === null && nextOrError === \"next\" && observer.complete) {\n        observer.complete();\n      }\n    }\n  };\n\n  Concast.prototype.addObserver = function (observer) {\n    if (!this.observers.has(observer)) {\n      this.deliverLastMessage(observer);\n      this.observers.add(observer);\n      ++this.addCount;\n    }\n  };\n\n  Concast.prototype.removeObserver = function (observer, quietly) {\n    if (this.observers.delete(observer) && --this.addCount < 1 && !quietly) {\n      this.handlers.error(new Error(\"Observable cancelled prematurely\"));\n    }\n  };\n\n  Concast.prototype.cleanup = function (callback) {\n    var _this = this;\n\n    var called = false;\n\n    var once = function () {\n      if (!called) {\n        called = true;\n\n        _this.observers.delete(observer);\n\n        callback();\n      }\n    };\n\n    var observer = {\n      next: once,\n      error: once,\n      complete: once\n    };\n    var count = this.addCount;\n    this.addObserver(observer);\n    this.addCount = count;\n  };\n\n  return Concast;\n}(Observable);\n\nexport { Concast };\nfixObservableSubclass(Concast);","map":{"version":3,"sources":["/Users/miftahalrasyid/Documents/kerja/personal/Tokopedia/pokeman/node_modules/@apollo/client/utilities/observables/Concast.js"],"names":["__extends","Observable","iterateObserversSafely","fixObservableSubclass","isPromiseLike","value","then","Concast","_super","sources","_this","call","observer","addObserver","removeObserver","observers","Set","addCount","promise","Promise","resolve","reject","handlers","next","result","sub","latest","error","unsubscribe","complete","shift","obs","subscribe","cancel","reason","catch","_","iterable","start","prototype","Array","from","deliverLastMessage","nextOrError","method","has","add","quietly","delete","Error","cleanup","callback","called","once","count"],"mappings":"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","sourcesContent":["import { __extends } from \"tslib\";\nimport { Observable } from \"./Observable.js\";\nimport { iterateObserversSafely } from \"./iteration.js\";\nimport { fixObservableSubclass } from \"./subclassing.js\";\nfunction isPromiseLike(value) {\n    return value && typeof value.then === \"function\";\n}\nvar Concast = (function (_super) {\n    __extends(Concast, _super);\n    function Concast(sources) {\n        var _this = _super.call(this, function (observer) {\n            _this.addObserver(observer);\n            return function () { return _this.removeObserver(observer); };\n        }) || this;\n        _this.observers = new Set();\n        _this.addCount = 0;\n        _this.promise = new Promise(function (resolve, reject) {\n            _this.resolve = resolve;\n            _this.reject = reject;\n        });\n        _this.handlers = {\n            next: function (result) {\n                if (_this.sub !== null) {\n                    _this.latest = [\"next\", result];\n                    iterateObserversSafely(_this.observers, \"next\", result);\n                }\n            },\n            error: function (error) {\n                var sub = _this.sub;\n                if (sub !== null) {\n                    if (sub)\n                        Promise.resolve().then(function () { return sub.unsubscribe(); });\n                    _this.sub = null;\n                    _this.latest = [\"error\", error];\n                    _this.reject(error);\n                    iterateObserversSafely(_this.observers, \"error\", error);\n                }\n            },\n            complete: function () {\n                if (_this.sub !== null) {\n                    var value = _this.sources.shift();\n                    if (!value) {\n                        _this.sub = null;\n                        if (_this.latest &&\n                            _this.latest[0] === \"next\") {\n                            _this.resolve(_this.latest[1]);\n                        }\n                        else {\n                            _this.resolve();\n                        }\n                        iterateObserversSafely(_this.observers, \"complete\");\n                    }\n                    else if (isPromiseLike(value)) {\n                        value.then(function (obs) { return _this.sub = obs.subscribe(_this.handlers); });\n                    }\n                    else {\n                        _this.sub = value.subscribe(_this.handlers);\n                    }\n                }\n            },\n        };\n        _this.cancel = function (reason) {\n            _this.reject(reason);\n            _this.sources = [];\n            _this.handlers.complete();\n        };\n        _this.promise.catch(function (_) { });\n        if (typeof sources === \"function\") {\n            sources = [new Observable(sources)];\n        }\n        if (isPromiseLike(sources)) {\n            sources.then(function (iterable) { return _this.start(iterable); }, _this.handlers.error);\n        }\n        else {\n            _this.start(sources);\n        }\n        return _this;\n    }\n    Concast.prototype.start = function (sources) {\n        if (this.sub !== void 0)\n            return;\n        this.sources = Array.from(sources);\n        this.handlers.complete();\n    };\n    Concast.prototype.deliverLastMessage = function (observer) {\n        if (this.latest) {\n            var nextOrError = this.latest[0];\n            var method = observer[nextOrError];\n            if (method) {\n                method.call(observer, this.latest[1]);\n            }\n            if (this.sub === null &&\n                nextOrError === \"next\" &&\n                observer.complete) {\n                observer.complete();\n            }\n        }\n    };\n    Concast.prototype.addObserver = function (observer) {\n        if (!this.observers.has(observer)) {\n            this.deliverLastMessage(observer);\n            this.observers.add(observer);\n            ++this.addCount;\n        }\n    };\n    Concast.prototype.removeObserver = function (observer, quietly) {\n        if (this.observers.delete(observer) &&\n            --this.addCount < 1 &&\n            !quietly) {\n            this.handlers.error(new Error(\"Observable cancelled prematurely\"));\n        }\n    };\n    Concast.prototype.cleanup = function (callback) {\n        var _this = this;\n        var called = false;\n        var once = function () {\n            if (!called) {\n                called = true;\n                _this.observers.delete(observer);\n                callback();\n            }\n        };\n        var observer = {\n            next: once,\n            error: once,\n            complete: once,\n        };\n        var count = this.addCount;\n        this.addObserver(observer);\n        this.addCount = count;\n    };\n    return Concast;\n}(Observable));\nexport { Concast };\nfixObservableSubclass(Concast);\n//# sourceMappingURL=Concast.js.map"]},"metadata":{},"sourceType":"module"}